GOOGLEのAPPSHEET
アプリケーションから出力されるJSONの構造をヘッダーを勘案して、シートに変換したい。
またそのシートの値をアプリケーションの表示に戻したい。


3層ヘッダーのときは
{A:{B:x,C:[a,b,c],D:{E:1,F:{},G:{H:1}}},I:{},J:[]}
は
[A,NULL,NULL]:TRUE
[A,B,NULL]:x
[A,B,C]:"a,b,c"
[A,D,NULL]:TRUE
[A,D,E]:1
[A,D,F]:TRUE
[A,D,G]:TRUE
[A,I,NULL]:TRUE
[A,J,NULL]:""


と変換する。
つまり、
VALUEがDICTのときは、TRUEを
VALUEがLISTのときは、文字列に連結したものを出す。[]のときは""
シートのデータ値として採用する
ヘッダーで埋まらないところにはNULLをいれる
予め決めたヘッダー層より深いものは無視する（今回は３層）
なお、リストの中にDICTは入らないものとする。

これであれば、
JSON⇔シートができるはず（もちろん層構造の深さ内限定）


