# 📊 Google AppSheetスタイル 受付データ管理アプリ

Google Apps Scriptで作成した、AppSheetのようなノーコード感覚で使える受付データ管理Webアプリケーションです。

## 🌟 特徴

- **ノーコード感覚**: AppSheetのような直感的なインターフェース
- **完全無料**: Google Apps Scriptを使用し、コストゼロで運用
- **モバイル対応**: レスポンシブデザインでスマートフォンからも利用可能
- **リアルタイム同期**: Googleスプレッドシートとリアルタイムで同期
- **高機能**: 検索、フィルタリング、CRUD操作をすべてサポート

## 📱 機能一覧

### ✅ 基本機能
- **受付データ一覧表示**: 美しいテーブル形式で受付データを表示
- **新規受付データ追加**: 階層構造対応の専用フォームから受付データを登録
- **受付データ編集**: 既存の受付データの内容を修正
- **受付データ削除**: 不要な受付データを安全に削除
- **リアルタイム検索・フィルタリング**: キーワードで受付データを即座に絞り込み

### 🎨 UI/UX
- **モダンなデザイン**: 洗練されたグラデーションとアニメーション
- **モバイルファースト**: スマートフォンでの使いやすさを重視
- **直感的な操作**: 絵文字アイコンで視覚的にわかりやすい
- **レスポンシブ**: 画面サイズに応じて最適なレイアウト

### 🔄 受付データ管理
- **Googleスプレッドシート連携**: 受付データはスプレッドシートに自動保存
- **階層構造対応**: 生物種や相談種別などの複雑な分類構造に対応
- **JSON仕様準拠**: 詳細なJSON仕様に基づくデータ構造管理
- **バックアップ不要**: Googleの堅牢なクラウドに自動保存
- **共有簡単**: URLを共有するだけで複数人での利用が可能

## 🚀 セットアップ手順

### 1. プロジェクトのデプロイ

**推奨方法（自動デプロイスクリプト使用）：**
```bash
# デプロイスクリプトを実行（自動でpush→deployを実行）
./deploy.sh
```

**手動デプロイ：**
```bash
# プロジェクトをGoogle Apps Scriptにプッシュ
clasp push

# Webアプリとしてデプロイ
clasp deploy --description "受付データ管理アプリ v1.0"
```

### 2. Webアプリの公開設定

1. [Google Apps Script](https://script.google.com)でプロジェクトを開く
2. 「デプロイ」→「新しいデプロイ」をクリック
3. 種類を「ウェブアプリ」に設定
4. 以下の設定を行う：
   - **説明**: `受付データ管理アプリ`
   - **実行ユーザー**: `自分`
   - **アクセスできるユーザー**: `全員` または `組織内のユーザー`
5. 「デプロイ」をクリック
6. 生成されたWebアプリURLをコピー

### 3. スプレッドシートでの利用

1. Googleスプレッドシートを開く
2. 「拡張機能」→「Apps Script」
3. このプロジェクトのコードを貼り付け
4. メニューから「📝 データ入力」→「🌐 Webアプリを開く」
5. デバッグ機能：「🔧 テスト・デバッグ」→「🔍 簡単テスト画面」

## 📖 使用方法

### 🌐 Webアプリ版（推奨）

1. デプロイしたWebアプリのURLにアクセス
2. **受付フォーム**: URL末尾に`?page=reception`を付けて専用受付フォームにアクセス
3. **デバッグページ**: URL末尾に`?page=debug`を付けてデバッグ機能にアクセス
4. 「➕ 新規追加」ボタンで受付データを登録
5. 一覧から受付データを選択して「✏️ 編集」で修正
6. 検索ボックスで受付データを絞り込み
7. 「🗑️ 削除」で不要な受付データを削除

### 📊 スプレッドシート版

1. Googleスプレッドシートで受付データ行を選択
2. メニューから「📝 データ入力」→「🗂️ 選択行のデータ編集」
3. または `Ctrl+M` でショートカット実行
4. テスト機能：「🔧 テスト・デバッグ」メニューから各種テスト実行

## 🗂️ ファイル構成

```
gws_clasp/
├── Code.js                 # メインのサーバーサイドロジック
├── views/                  # クライアント側ビュー(HTML)
│   ├── webapp.html         # Webアプリのメインページ
│   ├── reception_form.html # 受付データ専用入力フォーム
│   ├── debug.html          # デバッグ機能ページ
│   ├── form_builder.html   # CSV→フォームビルダー
│   └── test_csv_converter.html # CSV変換テスト
├── commands/               # ローカル実行用スクリプト(デプロイ対象外)
│   ├── gen_sample.js
│   └── csv_form_builder.js
├── docs/                   # ドキュメント/生成物/ローカルテスト(デプロイ対象外)
│   ├── template_example.html
│   ├── template_example.generated.html
│   └── csv2html_local_test.html
├── deploy.sh               # 自動デプロイスクリプト
├── appsscript.json         # プロジェクト設定
├── .clasp.json             # CLASP設定
├── .claspignore            # CLASP除外設定
├── jsonとシートの仕様.md    # 受付データのJSON仕様書
├── CLAUDE.md               # Claude用プロジェクト説明
└── README.md               # このファイル
```

## 📊 受付データ項目

このアプリケーションは**受付データ専用**に特化して設計されています：

### 主要データ構造
- **基本情報**: 受付番号、日時、相談者情報など
- **生物種分類**: 哺乳類、鳥類、爬虫類等の階層的分類構造
- **相談種別**: 問い合わせ内容の階層的分類
- **対応履歴**: 追加対応の回次管理
- **備考・詳細**: 自由記載欄

詳細な仕様は [`jsonとシートの仕様.md`](./jsonとシートの仕様.md) を参照してください。

## 🎨 カスタマイズ

### 📝 受付データ項目の変更

1. [`jsonとシートの仕様.md`](./jsonとシートの仕様.md) を参照してデータ構造を理解
2. `Code.js`の`createHeaders()`関数でスプレッドシート列構造を修正
3. `views/reception_form.html`で入力フォームのUIを調整
4. JSON変換ロジックを`Code.js`で対応

### 🎨 デザインの変更

- **メインアプリ**: `views/webapp.html`内のCSSを編集
- **受付フォーム**: `views/reception_form.html`内のCSSを編集  
- **デバッグページ**: `views/debug.html`内のCSSを編集

### 🔧 機能の追加

1. `Code.js`にサーバーサイド関数を追加
2. HTMLファイルでクライアントサイドから呼び出し
3. 必要に応じて新しいページモード（`?page=newpage`）を`doGet()`に追加

## 🔧 トラブルシューティング

### ❌ よくある問題

**Q: Webアプリにアクセスできない**
A: デプロイ設定で「アクセスできるユーザー」が正しく設定されているか確認してください。

**Q: データが保存されない**
A: Apps Scriptの実行権限を確認し、スプレッドシートへの書き込み権限があることを確認してください。

**Q: モバイルで表示が崩れる**
A: ブラウザのキャッシュをクリアするか、シークレットモードで試してください。

### 🐛 デバッグ方法

1. **専用デバッグページ**: WebアプリURLに`?page=debug`を付けてアクセス
2. **スプレッドシート内デバッグ**: メニュー「🔧 テスト・デバッグ」→「🔍 簡単テスト画面」
3. **Apps Scriptエディタ**: 「実行ログ」でサーバーサイドエラーを確認
4. **ブラウザ開発者ツール**: コンソールでクライアントサイドエラーを確認
5. **ログ出力**: `console.log()`を追加してデバッグ情報を出力

## 🚀 高度な活用

### 📈 受付データ分析

- Google Apps Scriptでピボットテーブルやグラフ機能を追加
- 受付件数や傾向の統計レポート自動生成
- 生物種別や相談種別の分析ダッシュボード

### 📧 通知機能

- 新規受付データ登録時のメール通知
- 対応期限の自動リマインダー機能
- 管理者向けの定期レポート配信

### 🔗 他サービス連携

- **Slack連携**: 受付通知をSlackチャンネルに配信
- **Gmail連携**: 相談者への自動返信メール
- **Googleカレンダー**: 対応予定の自動スケジュール登録

## 📄 ライセンス

MIT License - 自由に使用、改変、配布してください。

## 🤝 貢献

改善提案やバグ報告は歓迎します！

---

**🎉 Happy Coding! このアプリで受付データ管理を効率化しましょう！**
