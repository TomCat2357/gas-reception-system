<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="utf-8">
  <title>🔧 簡単テスト</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .btn { background: #4285f4; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
    .result { background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; margin: 10px 0; border-radius: 5px; }
  </style>
</head>
<body>
  <h1>🔧 簡単な動作テスト</h1>
  <button class="btn" onclick="testBasic()">基本テスト</button>
  <button class="btn" onclick="testAddData()">データ追加テスト</button>
  
  <div id="result" class="result">
    結果がここに表示されます...
  </div>

  <script>
    function showResult(message) {
      document.getElementById('result').innerHTML = message;
    }
    
    function testBasic() {
      showResult('基本テストを実行中...');
      google.script.run
        .withSuccessHandler((result) => {
          showResult(`✅ 基本テスト成功: ${result}`);
        })
        .withFailureHandler((error) => {
          showResult(`❌ 基本テストエラー: ${error.message}`);
        })
        .testCreateDataSheet();
    }
    
    function testAddData() {
      showResult('データ追加テストを実行中...');
      const testData = {
        name: 'テストユーザー',
        email: 'test@example.com',
        phone: '090-1234-5678',
        company: 'テスト会社',
        department: 'テスト部署',
        notes: 'テストデータです'
      };
      
      google.script.run
        .withSuccessHandler((result) => {
          showResult(`✅ データ追加成功: ${result}`);
        })
        .withFailureHandler((error) => {
          showResult(`❌ データ追加エラー: ${error.message}`);
        })
        .addNewData(testData);
    }
  </script>
</body>
</html>