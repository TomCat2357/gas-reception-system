<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="utf-8">
  <title>ğŸ”§ ç°¡å˜ãƒ†ã‚¹ãƒˆ</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .btn { background: #4285f4; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
    .result { background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; margin: 10px 0; border-radius: 5px; }
  </style>
</head>
<body>
  <h1>ğŸ”§ ç°¡å˜ãªå‹•ä½œãƒ†ã‚¹ãƒˆ</h1>
  <button class="btn" onclick="testBasic()">åŸºæœ¬ãƒ†ã‚¹ãƒˆ</button>
  <button class="btn" onclick="testAddData()">ãƒ‡ãƒ¼ã‚¿è¿½åŠ ãƒ†ã‚¹ãƒˆ</button>
  
  <div id="result" class="result">
    çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...
  </div>

  <script>
    function showResult(message) {
      document.getElementById('result').innerHTML = message;
    }
    
    function testBasic() {
      showResult('åŸºæœ¬ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...');
      google.script.run
        .withSuccessHandler((result) => {
          showResult(`âœ… åŸºæœ¬ãƒ†ã‚¹ãƒˆæˆåŠŸ: ${result}`);
        })
        .withFailureHandler((error) => {
          showResult(`âŒ åŸºæœ¬ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
        })
        .testCreateDataSheet();
    }
    
    function testAddData() {
      showResult('ãƒ‡ãƒ¼ã‚¿è¿½åŠ ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...');
      const testData = {
        name: 'ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼',
        email: 'test@example.com',
        phone: '090-1234-5678',
        company: 'ãƒ†ã‚¹ãƒˆä¼šç¤¾',
        department: 'ãƒ†ã‚¹ãƒˆéƒ¨ç½²',
        notes: 'ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§ã™'
      };
      
      google.script.run
        .withSuccessHandler((result) => {
          showResult(`âœ… ãƒ‡ãƒ¼ã‚¿è¿½åŠ æˆåŠŸ: ${result}`);
        })
        .withFailureHandler((error) => {
          showResult(`âŒ ãƒ‡ãƒ¼ã‚¿è¿½åŠ ã‚¨ãƒ©ãƒ¼: ${error.message}`);
        })
        .addNewData(testData);
    }
  </script>
</body>
</html>